---
import HeaderNav from '../components/HeaderNav.astro';
import FooterNav from '../components/FooterNav.astro';
import { siteConfig } from '../config/site';

interface SubSection {
  title: string;
  content: string;
}

interface Section {
  h2: string;
  content: string;
  h3?: SubSection[];
}

interface FAQItem {
  question: string;
  answer: string;
}

interface InternalLink {
  anchor: string;
  url: string;
  context?: string;
}

interface HeroImage {
  src?: string;
  alt: string;
}

interface Content {
  title: string;
  introduction: string;
  sections: Section[];
  faq: FAQItem[];
  internal_links?: InternalLink[];
  hero_image?: HeroImage;
}

interface Props {
  content: Content;
  seo?: unknown;
}

const { content } = Astro.props as Props;
const internalLinks = content.internal_links || [];
const heroImage = content.hero_image;
const hasWhatsapp = !!siteConfig.whatsappUrl;
---
<HeaderNav links={internalLinks} />
<main>
  <h1>{content.title}</h1>
  {heroImage && (
    <img
      src={heroImage.src || 'https://images.pexels.com/photos/376464/pexels-photo-376464.jpeg?auto=compress&cs=tinysrgb&w=1200'}
      alt={heroImage.alt}
      class="hero-image"
      loading="lazy"
    />
  )}
  <section class="intro-section">
    <p>{content.introduction}</p>
  </section>

  {internalLinks.length > 0 && (
    <section class="quick-links">
      {internalLinks.slice(0, 4).map((link) => (
        <a href={link.url} class="quick-link-pill">
          {link.anchor}
        </a>
      ))}
    </section>
  )}

  {hasWhatsapp && (
    <section class="cta-section">
      <p>
        {siteConfig.primaryCtaLabel} pour organiser vos trajets sur-mesure sur la CÃ´te d'Azur.
      </p>
      <a
        href={siteConfig.whatsappUrl}
        class="btn-whatsapp-large"
        target="_blank"
        rel="noopener noreferrer"
      >
        {siteConfig.primaryCtaLabel}
      </a>
    </section>
  )}

  {content.sections.map((section) => (
    <section>
      <h2>{section.h2}</h2>
      <p>{section.content}</p>
      {section.h3 &&
        section.h3.map((sub) => (
          <>
            <h3>{sub.title}</h3>
            <p>{sub.content}</p>
          </>
        ))}
    </section>
  ))}

  {content.faq.length > 0 && (
    <section>
      <h2>FAQ</h2>
      <div class="faq-list">
        {content.faq.map((item) => (
          <article class="faq-item">
            <h3>{item.question}</h3>
            <p>{item.answer}</p>
          </article>
        ))}
      </div>
    </section>
  )}

  {hasWhatsapp && (
    <section class="page-footer-cta">
      <p>
        Une question ou un projet de trajet ? Contactez-nous directement sur WhatsApp.
      </p>
      <a
        href={siteConfig.whatsappUrl}
        class="btn-whatsapp-large"
        target="_blank"
        rel="noopener noreferrer"
      >
        {siteConfig.primaryCtaLabel}
      </a>
    </section>
  )}
</main>
<FooterNav links={internalLinks} />
